(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{169:function(s,t,a){"use strict";var i=a(9);a.n(i).a},170:function(s,t,a){(s.exports=a(4)(!1)).push([s.i,".centered-input input{text-align:center}#inspireme--body--index{height:70vh}.__vuescroll .hasVBar{height:60vh!important}.mesa__header{display:flex;width:95%;justify-content:space-between}",""])},174:function(s,t,a){"use strict";a.r(t);var i={data:function(){return{loading:!0,showJoins:!1,actionButton:"",switchNavegator:!1,buttonKeys:[{accion:"JUNTAR",icon:"fas fa-circle-notch"},{accion:"COBRAR",icon:"fas fa-circle-notch"},{accion:"ELIMINAR",icon:"fas fa-circle-notch"},{accion:"SEPARAR",icon:"fas fa-circle-notch"},{accion:"MOVER",icon:"fas fa-circle-notch"}],ip:"",config:void 0,user:"",pisos:"",pisoActual:"0",cajaId:void 0,mesas:"",mesaId:"",mesaActual:"",arrayMesas:[],pin:"",dialog:!1,numcomen:1}},watch:{pisos:function(s){if(s.length>0){var t=s[0].id;"0"==this.pisoActual?this.getMesas(t):this.getMesas(this.pisoActual)}}},created:function(){this.pisos=JSON.parse(this.$store.getters.getPISOS),this.pin=this.$store.getters.getPIN,this.ip=this.$store.getters.getIP,this.user=this.$store.getters.getUSERNAME,this.pisoActual=this.$store.getters.getPISO_ACTUAL,this.cajaId=this.$store.getters.getCASH_BOX_ID,this.config=JSON.parse(this.$store.getters.getCONFIG_AXIOS)},methods:{getMesas:function(s){var t=this;this.mesas=[],this.loading=!0,this.pisoActual=s,axios.post("/api/tablet/mesas",{caja:this.cajaId,piso:this.pisoActual},this.config).then((function(s){var a=s.data;t.loading=!1,t.mesas=a.mesas})).catch((function(s){s.response?401===s.response.status&&t.sesionCaducada():s.request?console.log(s.request):console.log("Error",s.message)}))},getIcon:function(s){var t="";switch(s.st_cmd){case"1":break;case"3":t="fas fa-coins";break;case"2":t="mdi mdi-pot-steam"}return t},actionButtons:function(s){switch(s){case"JUNTAR":this.showJoins?(this.actionButton="",this.showJoins=!this.showJoins,this.unirMesas()):(this.actionButton="JUNTAR",this.arrayMesas=[],this.showJoins=!this.showJoins);break;case"SEPARAR":this.showJoins?(this.showJoins=!this.showJoins,this.separarMesas()):(this.actionButton="SEPARAR",this.arrayMesas=[],this.showJoins=!this.showJoins);break;case"MOVER":this.showJoins?(this.showJoins=!this.showJoins,this.moverMesas()):(this.actionButton="MOVER",this.arrayMesas=[],this.showJoins=!this.showJoins)}},actionMesa:function(s,t){var a=s.st_cmd;switch(this.actionButton){case"JUNTAR":if("3"!=a&"4"!=a){var i=!1;if(this.arrayMesas.forEach((function(t){t.id==s.id&&(i=!0,n=t)})),i){var e=this.arrayMesas.indexOf(n);this.arrayMesas.splice(e,1)}else{var o={id:s.id,id_cmd:s.id_cmd,st_cmd:s.st_cmd,st_join:1};this.arrayMesas.push(o)}}break;case"SEPARAR":if(1==s.juntada){i=!1;if(this.arrayMesas.forEach((function(t){t.id==s.id&&(i=!0,n=t)})),i)this.arrayMesas=[];else{o={id:s.id,id_cmd:s.id_cmd,st_cmd:s.st_cmd,st_join:1};this.arrayMesas=[],this.arrayMesas.push(o)}}break;case"MOVER":if("3"!=a&"4"!=a){var n;i=!1;if(this.arrayMesas.forEach((function(t){t.id==s.id&&(i=!0,n=t)})),i){e=this.arrayMesas.indexOf(n);this.arrayMesas.splice(e,1)}else if(this.arrayMesas.length<2){o={id:s.id,id_cmd:s.id_cmd,st_cmd:s.st_cmd};this.arrayMesas.push(o)}}break;default:this.newComanda(s,t)}},checkJoin:function(s){var t="";switch(this.actionButton){case"JUNTAR":case"SEPARAR":case"MOVER":t="mdi mdi-checkbox-blank-outline",this.arrayMesas.forEach((function(a){a.id==s&&(t="mdi mdi-checkbox-marked-outline")}))}return t},showChecksinMesa:function(s){var t=s.st_cmd,a=!1;switch(this.actionButton){case"JUNTAR":this.showJoins&"3"!=t&"4"!=t&&(a=!0);break;case"SEPARAR":this.showJoins&1==s.juntada&&(a=!0);break;case"MOVER":this.showJoins&"3"!=t&"4"!=t&&(a=!0)}return a},newComanda:function(s,t){var a=this;this.mesaId=t,this.mesaActual=s,this.$store.commit("SET_MESA_ACTUAL",JSON.stringify(s)),this.$store.commit("SET_ID_MESA_ACTUAL",t);this.$store.getters.getUSERID;if(""==s.st_cmd)this.dialog=!0;else{axios.post("api/tablet/comanda/nueva",{id:this.mesaId},this.config).then((function(s){var t=s.data;if(0!==t.status)a.$router.push({name:"Store"}),a.$store.commit("SET_PISO_ACTUAL",a.pisoActual);else if("Comanda no existe"==t.msg)a.swalMessage(t.msg),a.getMesas(a.pisoActual);else{var i=a.$store.getters.getUSERNAME,e="Comanda esta siendo Editada por mesero: ".concat(i);t.msg!=e?(Swal.fire({title:"Advertencia!",text:t.msg,icon:"warning",confirmButtonText:"OK"}),a.getMesas(a.pisoActual)):(a.$router.push({name:"Store"}),a.$store.commit("SET_PISO_ACTUAL",a.pisoActual))}})).catch((function(s){s.response?401===s.response.status&&a.sesionCaducada():s.request}))}},unirMesas:function(){var s=this,t=[],a="",i=[];this.arrayMesas.forEach((function(s){null!=s.id_cmd?(t.push(s.id_cmd),a=s.id):i.push(s.id)}));var e=t.length;if(1==e){axios.post("api/tablet/mesas/juntar",{id_mesa:a,mesas:i,id_cmd:t[0]},this.config).then((function(t){var a=t.data;"Ok"==a.msg?(s.arrayMesas=[],s.getMesas(s.pisoActual)):(s.swalMessage(a.msg),s.getMesas(s.pisoActual),s.arrayMesas=[])})).catch((function(t){s.arrayMesas=[],console.log(t)}))}else e>1?this.swalMessage("Seleccione solo una mesa que tenga comanda"):this.swalMessage("Seleecione al menos una mesa con comanda")},separarMesas:function(){var s=this,t="",a="";this.arrayMesas.forEach((function(s){0!=s.id_cmd&&(t=s.id_cmd),a=String(s.id)}));axios.post("api/tablet/mesas/separar",{id_mesa:a,id_cmd:t},this.config).then((function(t){var a=t.data;"Ok"==a.msg?(s.arrayMesas=[],s.getMesas(s.pisoActual)):(s.swalMessage(a.msg),s.getMesas(s.pisoActual),s.arrayMesas=[])})).catch((function(t){s.arrayMesas=[],console.log(t)}))},moverMesas:function(){var s=this,t="",a="";this.arrayMesas.forEach((function(s){null!=s.id_cmd?t=s.id_cmd:a=s.id}));axios.post("api/tablet/mesas/mover",{id_mesa:a,id_cmd:t},this.config).then((function(t){var a=t.data;"Ok"==a.msg?(s.arrayMesas=[],s.getMesas(s.pisoActual)):(s.swalMessage(a.msg),s.getMesas(s.pisoActual),s.arrayMesas=[])})).catch((function(t){s.arrayMesas=[],console.log(t)}))},logout:function(){this.$store.commit("SET_PIN",null),this.$router.push({name:"Login"})},sesionCaducada:function(){this.swalMessage("La sesion ha caducado"),this.$store.commit("SET_PIN",null),this.$router.push({name:"Login"})},swalMessage:function(s){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Advertencia!",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"warning";Swal.fire({title:t,text:s,icon:a,confirmButtonText:"Ok"})}}},e=(a(169),a(1)),o=Object(e.a)(i,(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("v-app",[a("v-app-bar",{staticStyle:{height:"3rem"},attrs:{app:"","clipped-right":""}},[a("v-slide-group",{attrs:{multiple:"","show-arrows":""}},s._l(s.pisos,(function(t,i){return a("v-slide-item",{key:i,scopedSlots:s._u([{key:"default",fn:function(i){var e=i.active;return[a("v-btn",{staticClass:"ma-2 white--text card card-block",attrs:{tile:"","input-value":e,color:t.id==s.pisoActual?"black":"light-green darken-4"},on:{click:function(a){return s.getMesas(t.id)}}},[s._v(s._s(t.name))])]}}],null,!0)})})),1),s._v(" "),a("v-spacer"),s._v(" "),a("v-switch",{attrs:{label:"Opciones de mesa"},model:{value:s.switchNavegator,callback:function(t){s.switchNavegator=t},expression:"switchNavegator"}})],1),s._v(" "),a("v-main",{attrs:{app:""}},[a("perfect-scrollbar",[a("v-col",{directives:[{name:"show",rawName:"v-show",value:s.loading,expression:"loading"}],attrs:{cols:"12"}},[a("app-spinner")],1),s._v(" "),a("v-card",{staticClass:"d-flex flex-wrap",attrs:{flat:"",tile:""}},s._l(s.mesas,(function(t,i){return a("v-card",{key:i,staticClass:"pa-2 mt-4 ml-4 mr-3",attrs:{color:"L"==t.st_mesa?"success":"error",dark:"",height:"6rem",width:"8rem"},on:{click:function(a){return s.actionMesa(t,t.id)}}},[a("v-card-title",{staticClass:"p-0"},[s._v("\n            "+s._s(t.nombre)+"\n            "),a("i",{directives:[{name:"show",rawName:"v-show",value:s.showChecksinMesa(t),expression:"showChecksinMesa(item)"}],class:s.checkJoin(t.id)})]),s._v(" "),a("v-card-text",{staticClass:"pb-0"},[s._v("\n            "+s._s(t.mesero)+"\n            "),a("i",{class:s.getIcon(t)})]),s._v(" "),a("v-card-text",{staticClass:"p-0"},[a("div",{staticClass:"mesa__header"},[a("i",{directives:[{name:"show",rawName:"v-show",value:1==t.juntada,expression:"item.juntada == 1"}],staticClass:"fas fa-link black--text"})])])],1)})),1)],1)],1),s._v(" "),s.switchNavegator?a("v-navigation-drawer",{attrs:{app:"",permanent:"",right:"",clipped:"",width:"12rem",height:"70vh"}},[a("v-list",{attrs:{dense:""}},[a("v-list-item",{on:{click:function(t){return s.actionButtons("JUNTAR")}}},[a("v-list-item-icon",[a("v-icon",[s._v("fas fa-circle-notch")])],1),s._v(" "),a("v-list-item-content",[a("v-list-item-title",[s._v(s._s(1==s.showJoins&&"JUNTAR"===s.actionButton?"OK":"JUNTAR"))])],1)],1),s._v(" "),a("v-list-item",{on:{click:function(t){return s.actionButtons("SEPARAR")}}},[a("v-list-item-icon",[a("v-icon",[s._v("fas fa-circle-notch")])],1),s._v(" "),a("v-list-item-content",[a("v-list-item-title",[s._v(s._s(1==s.showJoins&&"SEPARAR"===s.actionButton?"OK":"SEPARAR"))])],1)],1),s._v(" "),a("v-list-item",{on:{click:function(t){return s.actionButtons("MOVER")}}},[a("v-list-item-icon",[a("v-icon",[s._v("fas fa-circle-notch")])],1),s._v(" "),a("v-list-item-content",[a("v-list-item-title",[s._v(s._s(1==s.showJoins&&"MOVER"===s.actionButton?"OK":"MOVER"))])],1)],1)],1)],1):s._e(),s._v(" "),a("v-footer",{staticClass:"text--accent-3",staticStyle:{height:"3rem"},attrs:{app:""}},[a("span",[s._v(s._s(s.user))]),s._v(" "),a("v-spacer"),s._v(" "),a("v-btn",{staticClass:"ma-2 white--text mt-0",attrs:{tile:"","min-width":"8rem",color:"purple accent-4"},on:{click:s.logout}},[s._v("BLOQUEAR")])],1)],1)}),[],!1,null,null,null);t.default=o.exports},9:function(s,t,a){var i=a(170);"string"==typeof i&&(i=[[s.i,i,""]]);var e={hmr:!0,transform:void 0,insertInto:void 0};a(5)(i,e);i.locals&&(s.exports=i.locals)}}]);