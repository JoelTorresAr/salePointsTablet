(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{10:function(t,i,a){var e=a(172);"string"==typeof e&&(e=[[t.i,e,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};a(5)(e,s);e.locals&&(t.exports=e.locals)},171:function(t,i,a){"use strict";var e=a(10);a.n(e).a},172:function(t,i,a){(t.exports=a(4)(!1)).push([t.i,".mifuente{font-size:1.3vw;font-weight:700}",""])},175:function(t,i,a){"use strict";a.r(i);var e={data:function(){return{switchNavegator:!1,ip:"",familias:"",buttonKeys:[{accion:"cocina",icon:"mdi-pot-steam"},{accion:"anotacion",icon:"mdi-note-text-outline"},{accion:"precuenta",icon:"mdi-cash-register"}],articulos:[],articlesEnMesa:[],mesa:"",mesaId:"",total:"",config:"",dialog:!1,noteCmd:"",numcomen:0,cantidad:0,userID:0,pin:void 0,cash_box_id:void 0,disableMinusBtn:!1}},watch:{familias:function(t){if(t.length>0){var i=t[0];this.getArticles(i)}}},computed:{artList:function(){return this.articlesEnMesa}},created:function(){this.familias=JSON.parse(this.$store.getters.getFAMILIAS),this.mesa=JSON.parse(this.$store.getters.get_MESA_ACTUAL),this.mesaId=this.$store.getters.get_ID_MESA_ACTUAL,this.userID=this.$store.getters.getUSERID,this.cash_box_id=this.$store.getters.getCASH_BOX_ID,this.config=JSON.parse(this.$store.getters.getCONFIG_AXIOS),this.getArticlesinMesa()},methods:{getArticles:function(t){this.articulos=[],this.articulos=t.menus},getArticlesinMesa:function(){var t=this;axios.post("api/tablet/comanda/item/listar",{id_mesa:this.mesaId,id_caja:this.cash_box_id},this.config).then((function(i){var a=i.data;"Ok"==a.msg?(t.articlesEnMesa=a.prod,t.total=a.total):Swal.fire({title:"Advertencia!",text:a.msg,icon:"warning",confirmButtonText:"OK"})})).catch((function(i){i.response?401===i.response.status&&t.sesionCaducada():i.request}))},addToMesa:function(t,i){var a=this;axios.post("api/tablet/comanda/item/agregar ",{id_mesa:this.mesaId,id_producto:t.id,id_caja:this.cash_box_id},this.config).then((function(t){var i=t.data;"Ok"==i.msg?(a.articlesEnMesa=i.prod,a.total=i.total):Swal.fire({title:"Advertencia!",text:i.msg,icon:"warning",confirmButtonText:"OK"})})).catch((function(t){t.response?401===t.response.status&&a.sesionCaducada():t.request}))},addNote:function(){var t=this;axios.post("api/tablet/comanda/nota",{id_mesa:this.mesaId,nota:this.noteCmd,id_caja:this.cash_box_id},this.config).then((function(i){var a=i.data;t.dialog=!1,"OK"==a.msg?t.noteCmd="":(console.log(a),t.noteCmd="",Swal.fire({title:"Advertencia!",text:a.msg,icon:"warning",confirmButtonText:"OK"}))})).catch((function(t){console.log(t)}))},alterList:function(t,i){var a=1;switch(i){case"minus":this.disableMinusBtn=!0,a=-1,1==t.print&&t.increment<1?this.swalValidator(this.mesaId,t.idprod,t.id,a):this.consultaAlterarLista(this.mesaId,t.idprod,t.id,a);break;case"remove":a=0,"remove"==i&&1==t.print?this.swalValidator(this.mesaId,t.idprod,t.id,a):this.consultaAlterarLista(this.mesaId,t.idprod,t.id,a);break;default:this.consultaAlterarLista(this.mesaId,t.idprod,t.id,a)}},consultaAlterarLista:function(t,i,a,e){var s=this,n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",r="api/tablet/comanda/item/alterar";axios.post(r,{id_mesa:t,id_producto:i,id_detalle:a,cantidad:e,restring:n,auth:o,id_caja:this.cash_box_id},this.config).then((function(t){var i=t.data;s.disableMinusBtn=!1,"Ok"==i.msg?(s.articlesEnMesa=i.prod,s.total=i.total):Swal.fire({title:"Advertencia!",text:i.msg,icon:"warning",confirmButtonText:"OK"})})).catch((function(t){s.disableMinusBtn=!1,t.response?401===t.response.status&&s.sesionCaducada():t.request||Swal.fire({title:"Advertencia!",text:t.message.msg,icon:"warning",confirmButtonText:"OK"})}))},actionButton:function(t){switch(t){case"cocina":this.sendKitchen();break;case"precuenta":this.sendPrecuenta();break;case"anotacion":this.dialog=!0}},sendKitchen:function(){var t=this,i=this.$store.getters.getUSERNAME,a=this.$store.getters.getSTORE_ID;axios.post("api/tablet/comanda/imprimir/cocina",{id_mesa:this.mesaId,mesa:this.mesa.nombre,mozo:i,user_id:this.userID,tipo:"cocina",shop_id:a,id_caja:this.cash_box_id},this.config).then((function(i){var a=i.data;"OK"==a.msg?(Swal.fire({title:"Enviado a cocina!",text:a.msg,icon:"success",confirmButtonText:"OK"}),t.salir()):Swal.fire({title:"Advertencia!",text:a.msg,icon:"warning",confirmButtonText:"OK"})})).catch((function(i){i.response&&401===i.response.status&&t.sesionCaducada()}))},sendPrecuenta:function(){var t=this,i=0;if(this.articlesEnMesa.forEach((function(t){t.increment>0&&i++})),0==i){var a=this.$store.getters.getUSERNAME;axios.post("api/tablet/comanda/imprimir/precuenta",{id_mesa:this.mesaId,mesa:this.mesa.nombre,mozo:a,user_id:this.userID,tipo:"precuenta",id_caja:this.cash_box_id},this.config).then((function(i){var a=i.data;"OK"==a.msg?(t.$router.push({name:"Home"}),t.articlesEnMesa=a.prod,t.total=a.total):Swal.fire({title:"Advertencia!",text:a.msg,icon:"warning",confirmButtonText:"OK"})})).catch((function(i){i.response&&401===i.response.status&&t.sesionCaducada()}))}else Swal.fire({title:"Advertencia!",text:"Tiene detalles sin eliminar a cocina, eliminelos o envielos a cocina",icon:"warning",confirmButtonText:"OK"})},salir:function(){var t=this;axios.post("api/tablet/comanda/liberar",{id_mesa:this.mesaId,id_caja:this.cash_box_id},this.config).then((function(i){var a=i.data;"Ok"==a.msg?t.$router.push({name:"Home"}):Swal.fire({title:"Advertencia!",text:a.msg,icon:"warning",confirmButtonText:"OK"}).then((function(i){i.value&&t.$router.push({name:"Home"})}))})).catch((function(t){console.log(t)}))},sesionCaducada:function(){Swal.fire({title:"Advertencia!",text:"La sesion ha caducado",icon:"warning",confirmButtonText:"OK"}),this.$store.commit("SET_PIN",null),this.$router.push({name:"Login"})},swalMessage:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Advertencia!",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"warning";Swal.fire({title:i,text:t,icon:a,confirmButtonText:"Ok"})},swalValidator:function(t,i,a,e){var s=this;Swal.fire({title:"Esta accion requiere autorizaci√≥n",input:"text",inputValue:"",showCancelButton:!0,inputValidator:function(n){if(!n)return"Necesitas ingresar el pin de un administrador!";s.consultaAlterarLista(t,i,a,e,!0,n)}}).then((function(t){t.dismiss===Swal.DismissReason.cancel&&(s.disableMinusBtn=!1)})).value}}},s=(a(171),a(1)),n=Object(s.a)(e,(function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("v-app",[a("v-navigation-drawer",{attrs:{app:"",permanent:"",fixed:"",clipped:"",width:"35vw",height:"70vh"}},t._l(t.artList,(function(i,e){return a("v-list-item",{key:e,staticClass:"pl-2 pr-2"},[a("v-list-item-action",{staticClass:"mr-2"},[a("div",[a("v-btn",{attrs:{color:"primary",fab:"","x-small":"",dark:"",disabled:t.disableMinusBtn},on:{click:function(a){return t.alterList(i,"minus")}}},[a("v-icon",[t._v("mdi-minus")])],1),t._v("\n          "+t._s(i.cant)+"\n          "),a("v-btn",{attrs:{color:"primary",fab:"","x-small":"",dark:""},on:{click:function(a){return t.alterList(i,"plus")}}},[a("v-icon",[t._v("mdi-plus")])],1)],1)]),t._v(" "),a("v-list-item-content",[a("v-list-item-subtitle",[a("small",[a("b",{staticClass:"mifuente"},[t._v(t._s(i.name))])])])],1),t._v(" "),a("v-list-item-action",{staticClass:"ml-2"},[a("v-btn",{attrs:{color:"red",fab:"","x-small":"",dark:""},on:{click:function(a){return t.alterList(i,"remove")}}},[a("v-icon",[t._v("mdi-delete")])],1)],1)],1)})),1),t._v(" "),a("v-app-bar",{attrs:{app:"","clipped-left":"",height:"35vh"}},[a("v-toolbar-title",[a("strong",[t._v(t._s(t.mesa.nombre))])]),t._v(" "),a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"warning"},on:{click:t.salir}},[a("v-icon",[t._v("mdi-arrow-left-bold")])],1)],1),t._v(" "),a("v-main",{attrs:{app:"",height:"40vh"}},[a("v-toolbar",{attrs:{dense:"","min-width":"65vw"}},[a("v-slide-group",{attrs:{multiple:"","show-arrows":""}},t._l(t.familias,(function(i,e){return a("v-slide-item",{key:e,scopedSlots:t._u([{key:"default",fn:function(e){var s=e.active;return[a("v-btn",{staticClass:"ma-2 white--text card card-block",attrs:{tile:"","input-value":s,color:"light-blue darken-4"},on:{click:function(a){return t.getArticles(i)}}},[t._v(t._s(i.name))])]}}],null,!0)})})),1)],1),t._v(" "),a("perfect-scrollbar",[a("v-card",{staticClass:"d-flex flex-wrap",attrs:{flat:"",tile:""}},t._l(t.articulos,(function(i,e){return a("v-card",{key:e,staticClass:"pa-2 mt-4 ml-4",attrs:{color:"orange lighten-4",dark:"",width:"10rem",height:"8rem"},on:{click:function(a){return t.addToMesa(i,e)}}},[a("v-card-text",{staticClass:"black--text",staticStyle:{height:"5rem!important"}},[t._v(t._s(i.name))]),t._v(" "),a("v-card-actions",{staticClass:"black"},[a("strong",[t._v("S/."+t._s(i.total))])])],1)})),1)],1)],1),t._v(" "),a("v-footer",{staticClass:"text--accent-3",attrs:{app:"",fixed:"",height:"40vh"}},[a("strong",{staticClass:"subheading"},[t._v("Total: S/."+t._s(t.total))]),t._v(" "),a("v-spacer"),t._v(" "),t._l(t.buttonKeys,(function(i){return a("v-btn",{key:i.accion,staticClass:"mr-3 mt-0",attrs:{color:"primary"},on:{click:function(a){return t.actionButton(i.accion)}}},[a("v-icon",{attrs:{large:""}},[t._v(t._s(i.icon))])],1)}))],2),t._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:t.dialog,callback:function(i){t.dialog=i},expression:"dialog"}},[a("v-card",[a("v-card-text",{staticClass:"p-0"},[a("v-container",{staticClass:"pt-0 pb-0"},[a("v-row",[a("v-col",{staticClass:"pt-0 pb-0",attrs:{cols:"12"}},[a("v-text-field",{staticClass:"centered-input display-1",attrs:{label:"Ingrese nota de comanda",type:"text",rules:[function(t){return!!t||"Ingrese una nota"}],required:""},model:{value:t.noteCmd,callback:function(i){t.noteCmd=i},expression:"noteCmd"}})],1)],1)],1)],1),t._v(" "),a("v-card-actions",{staticClass:"pt-0 pb-0"},[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"error",text:""},on:{click:function(i){t.dialog=!1}}},[t._v("Close")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.addNote}},[t._v("Save")])],1)],1)],1)],1)}),[],!1,null,null,null);i.default=n.exports}}]);